<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Regimed | Paciente</title>
    <link rel="icon" href="/images/logo/LogoPositive.png" type="image/png">
    <link rel="stylesheet" href="/styles/paciente/paciente.css">
    <script src="https://kit.fontawesome.com/f5b8feb020.js" crossorigin="anonymous"></script>
    <script defer src="/scripts/paciente/agregarVacuna.js"></script>
    <script defer src="/scripts/paciente/agregarConsulta.js"></script>
    <script defer src="/scripts/paciente/agregarEstudio.js"></script>
    <script defer src="/scripts/paciente/editarHistorial.js"></script>
    <script defer src="/scripts/common/verConsulta.js"></script>
    <script defer src="/scripts/common/verEstudio.js"></script>
    <script defer src="/scripts/common/aside.js"></script>
    <script defer src="/scripts/common/tarjetaDatos.js"></script>
    <script defer src="/scripts/common/buscador.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script defer src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"
        integrity="sha512-CNgIRecGo7nphbeZ04Sc13ka07paqdeTu0WR1IM4kNcpmBAUSHSQX0FslNhTDadL4O5SAGapGt4FodqL8My0mA=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script defer src="https://www.google.com/recaptcha/api.js" async defer></script>
</head>

<body>
    <img src="/images/background/leaf-solid.svg" class="fondo__icono">
    <div class="contenido">
        <nav>
            <div class="nav__logo">
                <a onclick="abrirAside()" class="abrir__aside">
                    <i class="fa-solid fa-bars"></i>
                </a>
                <a href="/">
                    <img class="logo" src="/images/logo/LogoCompPositive.png" href="">
                </a>
            </div>
            <ul>
                <li>
                    <a href="/perfil">Perfil</a>
                </li>
                <li>
                    <a href="/cerrarSesion">Cerrar Sesión</a>
                </li>
            </ul>
        </nav>
        <div id="dark_background" class="dark_background" onclick="cerrarAside()"></div>
        <aside id="aside">
            <ul>
                <a onclick="cerrarAside()" class="cerrar__aside">
                    <i class="fa-solid fa-xmark"></i>
                </a>
                <li>
                    <a href="#informacion" class="seleccionado">
                        <i class="fa-solid fa-user"></i>
                        Información
                    </a>
                </li>
                <li>
                    <a href="#historial">
                        <i class="fa-solid fa-file-medical"></i>
                        Historial médico
                    </a>
                </li>
                <li>
                    <a href="#vacunas">
                        <i class="fa-solid fa-syringe"></i>
                        Vacunas
                    </a>
                </li>
                <li>
                    <a href="#consultas">
                        <i class="fa-solid fa-notes-medical"></i>
                        Consultas
                    </a>
                </li>
            </ul>
            <ul>
                <li>
                    <a id="abrir__tarjetaDatos" data-usuario-id="<%= idPaciente %>">
                        <i class="fa-solid fa-id-badge"></i>
                        Descargar Tarjeta
                    </a>
                </li>
            </ul>
        </aside>
        <main id="informacion">
            <div class="seccion">
                <div class="seccion__titulo">
                    <h1 class="seccion__titulo--titulo">
                        <i class="fa-solid fa-user"></i>Información General
                    </h1>
                </div>
                <div class="seccion__contenido informacion__general">
                    <div class="informacion__general--informacion informacion__primero">
                        <img src="<%= imagenAMostrar %>" alt="" id="imagenGuardada">
                        <p>
                            <%= nombre_comp %>
                        </p>
                        <ul>
                            <li>
                                <span>CURP</span>
                                <p>
                                    <%= curp %>
                                </p>
                            </li>
                            <li>
                                <span>Teléfono</span>
                                <p>
                                    <%= telefono %>
                                </p>
                            </li>
                        </ul>
                    </div>
                    <ul class="informacion__general--informacion informacion__lateral">
                        <li>
                            <span>Peso</span>
                            <% if (typeof peso !=='undefined' && peso !==null && peso !=='' && peso !==0) { %>
                                <p>
                                    <%= peso %> Kg
                                </p>
                                <% } else { %>
                                    <p class="vacio">Vacío</p>
                                    <% } %>
                        </li>
                        <li>
                            <span>IMC</span>
                            <% if (typeof peso !=='undefined' && typeof estatura !=='undefined' && peso !==null &&
                                estatura !==null && peso !=='' && estatura !=='' && peso !==0 && estatura !==0) { %>
                                <% var imc=peso / (estatura * estatura); %>
                                    <p>
                                        <%= imc.toFixed(2) %>
                                    </p>
                                    <% } else { %>
                                        <p class="vacio">Vacío</p>
                                        <% } %>
                        </li>
                        <li>
                            <span>Sexo</span>
                            <% if (typeof sexo !=='undefined' && sexo !==null && sexo !=='' ) { %>
                                <p>
                                    <%= sexo %>
                                </p>
                                <% } else { %>
                                    <p class="vacio">Vacío</p>
                                    <% } %>
                        </li>
                        <li>
                            <span>Nacimiento</span>
                            <% if (typeof nacimiento !=='undefined' && nacimiento !==null && nacimiento !=='' &&
                                nacimiento !=='0000-00-00' ) { %>
                                <p>
                                    <%= nacimiento %>
                                </p>
                                <% } else { %>
                                    <p class="vacio">Vacío</p>
                                    <% } %>
                        </li>
                        <li>
                            <span>Estatura</span>
                            <% if (typeof estatura !=='undefined' && estatura !==null && estatura !=='' && estatura
                                !==0) { %>
                                <p>
                                    <%= estatura %> m
                                </p>
                                <% } else { %>
                                    <p class="vacio">Vacío</p>
                                    <% } %>
                        </li>
                        <li>
                            <span>Tipo de sangre</span>
                            <% if (typeof sangre !=='undefined' && sangre !==null && sangre !=='' ) { %>
                                <p>
                                    <%= sangre %>
                                </p>
                                <% } else { %>
                                    <p class="vacio">Vacío</p>
                                    <% } %>
                        </li>
                        <li>
                            <span>Nacionalidad</span>
                            <% if (typeof nacionalidad !=='undefined' && nacionalidad !==null && nacionalidad !=='' ) {
                                %>
                                <p>
                                    <%= nacionalidad %>
                                </p>
                                <% } else { %>
                                    <p class="vacio">Vacío</p>
                                    <% } %>
                        </li>
                        <li>
                            <span>Edad</span>
                            <% if (typeof nacimiento !=='undefined' && nacimiento !==null && nacimiento !=='' &&
                                nacimiento !=='0000-00-00' ) { %>
                                <% var fechaNacimiento=new Date(nacimiento); var fechaActual=new Date(); var
                                    edad=fechaActual.getFullYear() - fechaNacimiento.getFullYear(); if
                                    (fechaActual.getMonth() < fechaNacimiento.getMonth() ||
                                    (fechaActual.getMonth()===fechaNacimiento.getMonth() && fechaActual.getDate() <
                                    fechaNacimiento.getDate())) { edad--; } %>
                                    <p>
                                        <%= edad %> años
                                    </p>
                                    <% } else { %>
                                        <p class="vacio">Vacío</p>
                                        <% } %>
                        </li>
                    </ul>
                </div>
            </div>
            
            <div id="historial" class="seccion">
                <div class="seccion__titulo">
                    <h1 class="seccion__titulo--titulo">
                        <i class="fa-solid fa-file-medical"></i> Historial Médico
                    </h1>
                    <div class="seccion__titulo--boton">
                        <button type="button" class="boton-datos" id="abrir__editarHistorial">
                            <i class="fa-solid fa-pen-to-square"></i><p>Editar</p>
                        </button>
                    </div>
                </div>

                <div class="seccion__contenido seccion__contenido--historial">
                <% if (historial && (historial.pp && Object.values(historial.pp).some(value => value) || historial.pnp && Object.values(historial.pnp).some(value => value) || historial.ah && Object.values(historial.ah).some(value => value))) { %>
                    <% if (historial.pp && Object.values(historial.pp).some(value => value)) { %>
                    <h2>Personales Patológicos</h2>
                    <div class="contenido__personalesPatologicos">
                        <% if (historial.pp.alergias) { %>
                        <span>Alergias:</span>
                        <input name="alergias" type="text" class="input" value="<%= historial.pp.alergias %>" disabled>
                        <% } %>
                        <% if (historial.pp.tabaco) { %>
                        <span>Tabaco:</span>
                        <input name="tabaco" type="text" class="input" value="<%= historial.pp.tabaco %>" disabled>
                        <% } %>
                        <% if (historial.pp.alcohol) { %>
                        <span>Alcohol:</span>
                        <input name="alcohol" type="text" class="input" value="<%= historial.pp.alcohol %>" disabled>
                        <% } %>
                        <% if (historial.pp.drogas) { %>
                        <span>Drogas:</span>
                        <input name="drogas" type="text" class="input" value="<%= historial.pp.drogas %>" disabled>
                        <% } %>
                        <% if (historial.pp.padecimientos) { %>
                        <span>Padecimientos:</span>
                        <input name="padecimientos" type="text" class="input" value="<%= historial.pp.padecimientos %>" disabled>
                        <% } %>
                        <% if (historial.pp.medicamentos) { %>
                        <span>Medicamentos:</span>
                        <input name="medicamentos" type="text" class="input" value="<%= historial.pp.medicamentos %>" disabled>
                        <% } %>
                        <% if (historial.pp.quirurgicos) { %>
                        <span>Quirúrgicos:</span>
                        <input name="quirurgicos" type="text" class="input" value="<%= historial.pp.quirurgicos %>" disabled>
                        <% } %>
                        <% if (historial.pp.traumatologicos) { %>
                        <span>Traumatológicos:</span>
                        <input name="traumatologicos" type="text" class="input" value="<%= historial.pp.traumatologicos %>" disabled>
                        <% } %>
                        <% if (historial.pp.transfusionales) { %>
                        <span>Transfusionales:</span>
                        <input name="transfusionales" type="text" class="input" value="<%= historial.pp.transfusionales %>" disabled>
                        <% } %>
                        <% if (historial.pp.intoleranciaMedicamentos) { %>
                        <span>Intolerancia a Medicamentos:</span>
                        <input name="intoleranciaMedicamentos" type="text" class="input" value="<%= historial.pp.intoleranciaMedicamentos %>" disabled>
                        <% } %>
                        <% if (historial.pp.otros) { %>
                        <span>Otros:</span>
                        <input name="otros" type="text" class="input" value="<%= historial.pp.otros %>" disabled>
                        <% } %>
                    </div>
                    <% } %>
                    
                    <% if (historial.pnp && Object.values(historial.pnp).some(value => value)) { %>
                    <h2>Personales No Patológicos</h2>
                    <div class="contenido__personalesNoPatologicos">
                        <% if (historial.pnp.ejercicio) { %>
                        <span>Ejercicio:</span>
                        <input name="ejercicio" type="text" class="input" value="<%= historial.pnp.ejercicio %>" disabled>
                        <% } %>
                        <% if (historial.pnp.suplementos) { %>
                        <span>Suplementos:</span>
                        <input name="suplementos" type="text" class="input" value="<%= historial.pnp.suplementos %>" disabled>
                        <% } %>
                        <% if (historial.pnp.viajesRecientes) { %>
                        <span>Viajes Recientes:</span>
                        <input name="viajesRecientes" type="text" class="input" value="<%= historial.pnp.viajesRecientes %>" disabled>
                        <% } %>
                        <% if (historial.pnp.tatuajes) { %>
                        <span>Tatuajes:</span>
                        <input name="tatuajes" type="text" class="input" value="<%= historial.pnp.tatuajes %>" disabled>
                        <% } %>
                        <% if (historial.pnp.perforaciones) { %>
                        <span>Perforaciones:</span>
                        <input name="perforaciones" type="text" class="input" value="<%= historial.pnp.perforaciones %>" disabled>
                        <% } %>
                        <% if (historial.pnp.otros) { %>
                        <span>Otros:</span>
                        <input name="otros" type="text" class="input" value="<%= historial.pnp.otros %>" disabled>
                        <% } %>
                    </div>
                    <% } %>
                    
                    <% if (historial.ah && Object.values(historial.ah).some(value => value)) { %>
                    <h2>Antecedentes Heredofamiliares</h2>
                    <div class="contenedor__antecedentesHeredofamiliares">
                        <table class="tabla__antecedentesHeredofamiliares">
                            <thead>
                                <tr>
                                    <th></th>
                                    <th class="familiares familiar__abuelos">Abuelos</th>
                                    <th class="familiares familiar__padre">Padre</th>
                                    <th class="familiares familiar__madre">Madre</th>
                                    <th class="familiares familiar__hermanos">Hermanos</th>
                                </tr>
                            </thead>
                            <tbody>
                                <% if (historial.ah.diabetesAbuelos || historial.ah.diabetesPadre || historial.ah.diabetesMadre || historial.ah.diabetesHermanos) { %>
                                <tr>
                                    <td>Diabetes</td>
                                    <td><input name="diabetesAbuelos" type="text" class="input input__diabetes--abuelos" value="<%= historial.ah.diabetesAbuelos %>" disabled></td>
                                    <td><input name="diabetesPadre" type="text" class="input input__diabetes--padre" value="<%= historial.ah.diabetesPadre %>" disabled></td>
                                    <td><input name="diabetesMadre" type="text" class="input input__diabetes--madre" value="<%= historial.ah.diabetesMadre %>" disabled></td>
                                    <td><input name="diabetesHermanos" type="text" class="input input__diabetes--hermanos" value="<%= historial.ah.diabetesHermanos %>" disabled></td>
                                </tr>
                                <% } %>

                                <% if (historial.ah.nefropatiasAbuelos || historial.ah.nefropatiasPadre || historial.ah.nefropatiasMadre || historial.ah.nefropatiasHermanos) { %>
                                <tr>
                                    <td>Nefropatías</td>
                                    <td><input name="nefropatiasAbuelos" type="text" class="input" value="<%= historial.ah.nefropatiasAbuelos %>" disabled></td>
                                    <td><input name="nefropatiasPadre" type="text" class="input" value="<%= historial.ah.nefropatiasPadre %>" disabled></td>
                                    <td><input name="nefropatiasMadre" type="text" class="input" value="<%= historial.ah.nefropatiasMadre %>" disabled></td>
                                    <td><input name="nefropatiasHermanos" type="text" class="input" value="<%= historial.ah.nefropatiasHermanos %>" disabled></td>
                                </tr>
                                <% } %>

                                <% if (historial.ah.mentalesAbuelos || historial.ah.mentalesPadre || historial.ah.mentalesMadre || historial.ah.mentalesHermanos) { %>
                                <tr>
                                    <td>Enfermedades Mentales</td>
                                    <td><input name="mentalesAbuelos" type="text" class="input" value="<%= historial.ah.mentalesAbuelos %>" disabled></td>
                                    <td><input name="mentalesPadre" type="text" class="input" value="<%= historial.ah.mentalesPadre %>" disabled></td>
                                    <td><input name="mentalesMadre" type="text" class="input" value="<%= historial.ah.mentalesMadre %>" disabled></td>
                                    <td><input name="mentalesHermanos" type="text" class="input" value="<%= historial.ah.mentalesHermanos %>" disabled></td>
                                </tr>
                                <% } %>

                                <% if (historial.ah.hipertensionAbuelos || historial.ah.hipertensionPadre || historial.ah.hipertensionMadre || historial.ah.hipertensionHermanos) { %>
                                <tr>
                                    <td>Hipertensión Arterial</td>
                                    <td><input name="hipertensionAbuelos" type="text" class="input" value="<%= historial.ah.hipertensionAbuelos %>" disabled></td>
                                    <td><input name="hipertensionPadre" type="text" class="input" value="<%= historial.ah.hipertensionPadre %>" disabled></td>
                                    <td><input name="hipertensionMadre" type="text" class="input" value="<%= historial.ah.hipertensionMadre %>" disabled></td>
                                    <td><input name="hipertensionHermanos" type="text" class="input" value="<%= historial.ah.hipertensionHermanos %>" disabled></td>
                                </tr>
                                <% } %>

                                <% if (historial.ah.oncologicosAbuelos || historial.ah.oncologicosPadre || historial.ah.oncologicosMadre || historial.ah.oncologicosHermanos) { %>
                                <tr>
                                    <td>Oncológicos</td>
                                    <td><input name="oncologicosAbuelos" type="text" class="input" value="<%= historial.ah.oncologicosAbuelos %>" disabled></td>
                                    <td><input name="oncologicosPadre" type="text" class="input" value="<%= historial.ah.oncologicosPadre %>" disabled></td>
                                    <td><input name="oncologicosMadre" type="text" class="input" value="<%= historial.ah.oncologicosMadre %>" disabled></td>
                                    <td><input name="oncologicosHermanos" type="text" class="input" value="<%= historial.ah.oncologicosHermanos %>" disabled></td>
                                </tr>
                                <% } %>

                                <% if (historial.ah.hepatopatiasAbuelos || historial.ah.hepatopatiasPadre || historial.ah.hepatopatiasMadre || historial.ah.hepatopatiasHermanos) { %>
                                <tr>
                                    <td>Hepatopatías</td>
                                    <td><input name="hepatopatiasAbuelos" type="text" class="input" value="<%= historial.ah.hepatopatiasAbuelos %>" disabled></td>
                                    <td><input name="hepatopatiasPadre" type="text" class="input" value="<%= historial.ah.hepatopatiasPadre %>" disabled></td>
                                    <td><input name="hepatopatiasMadre" type="text" class="input" value="<%= historial.ah.hepatopatiasMadre %>" disabled></td>
                                    <td><input name="hepatopatiasHermanos" type="text" class="input" value="<%= historial.ah.hepatopatiasHermanos %>" disabled></td>
                                </tr>
                                <% } %>

                                <% if (historial.ah.heredoOtrosAbuelos || historial.ah.heredoOtrosPadre || historial.ah.heredoOtrosMadre || historial.ah.heredoOtrosHermanos) { %>
                                <tr>
                                    <td>Otros</td>
                                    <td><input name="heredoOtrosAbuelos" type="text" class="input" value="<%= historial.ah.heredoOtrosAbuelos %>" disabled></td>
                                    <td><input name="heredoOtrosPadre" type="text" class="input" value="<%= historial.ah.heredoOtrosPadre %>" disabled></td>
                                    <td><input name="heredoOtrosMadre" type="text" class="input" value="<%= historial.ah.heredoOtrosMadre %>" disabled></td>
                                    <td><input name="heredoOtrosHermanos" type="text" class="input" value="<%= historial.ah.heredoOtrosHermanos %>" disabled></td>
                                </tr>
                                <% } %>
                            </tbody>
                        </table>
                    </div>
                    <% } %>
                    <span>Última modificación: <%= historial.ultimaModificacion %> <br>
                        por el médico <%= historial.doctor.nombre %> <br>
                        de cédula <%= historial.doctor.cedula %></span>
                        
                    </div>
                    <% } else { %>
                        <p>No hay datos en el historial.</p>
                    <% } %>
                </div>

                <div id="vacunas" class="seccion">
                    <div class="seccion__titulo">
                        <h1 class="seccion__titulo--titulo">
                            <i class="fa-solid fa-syringe"></i> Vacunas
                        </h1>
                        <div class="seccion__titulo--boton">
                            <button type="button" class="boton-datos" id="abrir__agregarVacuna">
                                <i class="fa-solid fa-plus"></i><p>Agregar</p>
                            </button>
                        </div>
                    </div>
                    <div class="seccion__vacunas">
                        <div class="seccion__contenido seccion__vacunas--contenedor">
                            <div class="buscador">
                                <input class="input" type="text" id="buscar__vacuna" placeholder="Buscar vacuna...">
    
                                <select id="ordenarPorVacunas">
                                    <option value="" selected disabled>Ordenar</option>
                                    <option value="nombre">Nombre</option>
                                    <option value="fecha">Fecha</option>
                                    <option value="profesional">Profesional</option>
                                </select>
                                
                                <select id="mostrarVacunas">
                                    <option value="" selected disabled>Mostrar</option>
                                    <option value="cualquiera">Cualquier fecha</option>
                                    <option value="unDia">Últimas 24 horas</option>
                                    <option value="unaSemana">Última semana</option>
                                    <option value="unMes">Último mes</option>
                                    <option value="unAño">Último año</option>
                                </select>
                                
                            </div>
                            
                            <div class="seccion__contenido--vacunas vacunas">
                                <% vacunas.forEach(vacunas=> { %>
                                    <div class="vacuna">
                                        <div class="vacuna--informacion">
                                            <p class="vacuna__nombre"><%= vacunas.vacuna_aplicada %></p>
                                            <p>Fabricante: <%= vacunas.fabricante %></p>
                                            <p>Aplicación: <%= vacunas.fechaAplicacion %></p>
                                            <p>Dosis: <%= vacunas.dosisAdministrada %></p>
                                            <p>No. Lote: <%= vacunas.numeroLote %></p>
                                            <p>No. Serie: <%= vacunas.numeroSerie %></p>
                                            <p>Lugar de administración: <%= vacunas.lugarAdministracion %></p>
                                            <p>Profesional: <%= vacunas.nombre %></p>
                                            <p>Cédula del profesional: <%= vacunas.cedula %></p>
                                            <% if (vacunas.siguienteDosis && vacunas.siguienteDosis !== '0000-00-00 00:00:00' && vacunas.siguienteDosis !== 'NaN-NaN-NaN') { %>
                                                <p class="siguiente-dosis">Siguiente dosis: <%= vacunas.siguienteDosis %></p>
                                            <% } %>
                                        </div>
                                    </div>
                                <%})%>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="consultas" class="seccion">
                    <div class="seccion__titulo">
                        <h1 class="seccion__titulo--titulo">
                            <i class="fa-solid fa-notes-medical"></i> Consultas
                        </h1>
                    </div>
                    <div class="seccion__consultas">
                        <div class="seccion__contenido seccion__consultas--contenedor">
                            <div class="modal__subtitulo">
                                <h2>Consultas</h2>
                                <div class="seccion__titulo--boton">
                                    <button type="button" class="boton-datos" id="abrir__agregarConsulta">
                                        <i class="fa-solid fa-plus"></i> Agregar
                                    </button>
                                </div>
                            </div>
                            <div class="buscador" id="buscador--consultas">
                                <input class="input" type="text" id="buscar__consulta" placeholder="Buscar consulta...">
    
                                <select id="ordenarPorConsultas">
                                    <option value="" selected disabled>Ordenar</option>
                                    <option value="nombre">Nombre</option>
                                    <option value="fecha">Fecha</option>
                                    <option value="profesional">Profesional</option>
                                </select>
                                
                                <select id="mostrarConsultas">
                                    <option value="" selected disabled>Mostrar</option>
                                    <option value="cualquiera">Cualquier fecha</option>
                                    <option value="unDia">Últimas 24 horas</option>
                                    <option value="unaSemana">Última semana</option>
                                    <option value="unMes">Último mes</option>
                                    <option value="unAño">Último año</option>
                                </select>
                            </div>
                            <div class="seccion__contenido--consultas">
                                <% consultas.forEach(consultas=> { %>
                                    <div class="consulta">
                                        <div class="consulta--informacion">
                                            <p class="observaciones">
                                                <%= consultas.observaciones %>
                                            </p>
                                            <p>Profesional: <%= consultas.nombre %>
                                            </p>
                                            <p>Cédula del profesional: <%= consultas.cedula %>
                                            </p>
                                            <p>Fecha: <%= consultas.fechaConsulta %>
                                            </p>
                                        </div>
                                        <div class="consulta__boton">
                                            <button class="boton-datos abrir__consulta"
                                                data-consulta-id="<%= consultas.consulta_id %>">
                                                Ver Consulta
                                            </button>
                                        </div>
                                    </div>
                                    <% }) %>
                            </div>
                        </div>
                        <div class="seccion__contenido seccion__consultas--contenedor">
                            <div class="modal__subtitulo">
                                <h2>Estudios</h2>
                                <div class="seccion__titulo--boton">
                                    <button type="button" class="boton-datos" id="abrir__agregarEstudio">
                                        <i class="fa-solid fa-plus"></i> Agregar
                                    </button>
                                </div>
                            </div>
                            <div class="buscador" id="buscador--estudios">
                                <input class="input" type="text" id="buscar__estudio" placeholder="Buscar estudio...">
    
                                <select id="ordenarPorEstudios">
                                    <option value="" selected disabled>Ordenar</option>
                                    <option value="nombre">Nombre</option>
                                    <option value="fecha">Fecha</option>
                                    <option value="profesional">Profesional</option>
                                </select>
                                
                                <select id="mostrarEstudios">
                                    <option value="" selected disabled>Mostrar</option>
                                    <option value="cualquiera">Cualquier fecha</option>
                                    <option value="unDia">Últimas 24 horas</option>
                                    <option value="unaSemana">Última semana</option>
                                    <option value="unMes">Último mes</option>
                                    <option value="unAño">Último año</option>
                                </select>
                            </div>
                            <div class="seccion__contenido--estudios">
                                <% estudios.forEach(estudios=> { %>
                                    <div class="estudio">
                                        <div class="estudio--informacion">
                                            <p class="estudio__nombre">
                                                <%= estudios.tipoEstudio %>
                                            </p>
                                            <p>Motivo: <%= estudios.motivoEstudio %>
                                            </p>
                                            <p>Profesional: <%= estudios.nombre %>
                                            </p>
                                            <p>Cédula del profesional: <%= estudios.cedula %>
                                            </p>
                                            <p>Fecha: <%= estudios.fechaEstudio %>
                                            </p>
                                        </div>
                                        <div class="estudio__boton">
                                            <button class="boton-datos abrir__estudio"
                                                data-estudio-id="<%= estudios.estudio_id %>">
                                                Ver Estudio
                                            </button>
                                        </div>
                                    </div>
                                    <% }) %>
                            </div>
                        </div>
                    </div>
                </div>
        </main>
    </div>

    <div id="fondo__agregarVacuna" class="fondo__modal">
        <form id="modal__agregarVacuna" class="modal">
            <h1 class="modal__titulo">
                <i class="fa-solid fa-syringe"></i> Agregar Vacuna
            </h1>
            <div class="modal__contenido modal__contenido--agregarVacuna">
                <label class="label">Vacuna aplicada <span class="asterisk">*</span></label>
                <input name="vacunaAplicada" type="text" class="input">
                <label class="label">Fabricante <span class="asterisk">*</span></label>
                <input name="fabricante" type="text" class="input">
                <label class="label">No. de lote <span class="asterisk">*</span></label>
                <input name="numeroLote" type="text" class="input">
                <label class="label">No. de serie <span class="asterisk">*</span></label>
                <input name="numeroSerie" type="text" class="input">
                <label class="label">Fecha de aplicación</label>
                <input name="fechaAplicacion" type="date" class="input" id="fechaAplicacion">
                <label class="label">Dosis administrada <span class="asterisk">*</span></label>
                <select name="dosisAdministrada" class="input" id="dosisAdministrada">
                    <option selected disabled>Selecciona</option>
                    <option value="Única">Única</option>
                    <option value="1ª dosis">1ª dosis</option>
                    <option value="2ª dosis">2ª dosis</option>
                    <option value="3ª dosis">3ª dosis</option>
                    <option value="4ª dosis">4ª dosis</option>
                    <option value="5ª dosis">5ª dosis</option>
                    <option value="Refuerzo">Refuerzo</option>
                </select>
                <label class="label">Lugar de administración <span class="asterisk">*</span></label>
                <input name="lugarAdministacion" type="text" class="input">
                <label class="label">Siguiente dosis <span class="asterisk asterisk-siguienteDosis">*</span></label>
                <input name="siguienteDosis" type="date" class="input" id="siguienteDosis" disabled>
            </div>
            <div class="modal__botones">
                <button type="submit" class="boton-datos" id="agregarVacuna">
                    <i class="fa-solid fa-plus"></i> Agregar
                </button>
                <button type="button" class="boton-datos boton-cancelar" id="cerrar__agregarVacuna">
                    <i class="fa-solid fa-x"></i> Cancelar
                </button>
            </div>
        </form>
    </div>

    <div id="fondo__agregarConsulta" class="fondo__modal">
        <form id="modal__agregarConsulta" class="modal">
            <h1 class="modal__titulo">
                <i class="fa-solid fa-notes-medical"></i> Agregar Consulta
            </h1>
            <div class="modal__contenido modal__contenido--agregarConsulta">
                <div class="consultas__textArea">
                    <label class="label">Observaciones <span class="asterisk">*</span></label>
                    <textarea name="observaciones" class="input"></textarea>
                    <label class="label">Pronostico <span class="asterisk">*</span></label>
                    <textarea name="pronostico" class="input"></textarea>
                    <label class="label">Plan Terapeutico <span class="asterisk">*</span></label>
                    <textarea name="planTerapeutico" class="input"></textarea>
                </div>

                <div class="modal__contenido--medicamentos">
                    <div class="modal__subtitulo">
                        <h2>Medicamentos</h2>
                        <div class="seccion__titulo--boton">
                            <button type="button" class="boton-datos" id="agregarMedicamento">
                                <i class="fa-solid fa-plus"></i> Añadir
                            </button>
                        </div>
                    </div>
                    <div id="medicamentosContainer"></div>
                </div>
            </div>
            <div class="modal__botones">
                <button type="submit" class="boton-datos" id="agregarConsulta">
                    <i class="fa-solid fa-plus"></i> Agregar
                </button>
                <button type="button" class="boton-datos boton-cancelar" id="cerrar__agregarConsulta">
                    <i class="fa-solid fa-x"></i> Cancelar
                </button>
            </div>
        </form>
    </div>

    <div id="fondo__consulta" class="fondo__modal">
        <div id="ventana__consulta" class="modal">
            <h1 class="modal__titulo">
                <i class="fa-solid fa-square-virus"></i>Consulta
            </h1>
            <div class="modal__contenido consulta__contenido">
                <div class="consulta__datos" id="consulta__datos">
                    <!-- Aquí se mostrarán las observaciones, pronóstico y plan terapéutico -->
                </div>
                <div id="consulta__medicamentos" class="consulta__dato">
                    <h2>Medicamentos</h2>
                    <div class="consulta__medicamentos">
                        <table>
                            <!-- Aquí se mostrarán los medicamentos -->
                        </table>
                    </div>
                </div>
            </div>
            <div class="modal__botones">
                <button id="cerrar__consulta" class="boton-datos">Cerrar</button>
            </div>
        </div>
    </div>

    <div id="fondo__agregarEstudio" class="fondo__modal">
        <form id="modal__agregarEstudio" class="modal">
            <h1 class="modal__titulo">
                <i class="fa-solid fa-notes-medical"></i> Agregar Estudio
            </h1>
            <div class="modal__contenido modal__contenido--agregarEstudio">
                <div class="consultas__textArea">
                    <label class="label">Tipo de estudio <span class="asterisk">*</span></label>
                    <input name="tipoEstudio" class="input" type="text">
                    <label class="label">Motivo del estudio <span class="asterisk">*</span></label>
                    <textarea name="motivoEstudio" class="input"></textarea>
                    <label class="label">Descripción <span class="asterisk">*</span></label>
                    <textarea name="descripcion" class="input"></textarea>
                    <label class="label">Resultados</label>
                    <textarea name="resultados" class="input"></textarea>
                    <!-- <label class="label">Archivos adjuntos</label>
			        <input class="inputFile" name="archivosAdjuntos" id="archivosAdjuntos" type="file"> -->
                    <label class="label">Fecha del estudio</label>
                    <input name="fechaEstudio" type="date" class="input" id="fechaEstudio">

                </div>
            </div>
            <div class="modal__botones">
                <button type="submit" class="boton-datos" id="agregarEstudio">
                    <i class="fa-solid fa-plus"></i> Agregar
                </button>
                <button type="button" class="boton-datos boton-cancelar" id="cerrar__agregarEstudio">
                    <i class="fa-solid fa-x"></i> Cancelar
                </button>
            </div>
        </form>
    </div>

    <div id="fondo__estudio" class="fondo__modal">
        <div id="ventana__estudio" class="modal">
            <h1 class="modal__titulo">
                <i class="fa-solid fa-square-virus"></i> Estudio
            </h1>
            <div class="modal__contenido estudio__contenido">
                <div class="estudio__datos" id="estudio__datos">
                    <!-- Aquí se mostrarán los detalles del estudio -->
                </div>
            </div>
            <div class="modal__botones">
                <button id="cerrar__estudio" class="boton-datos">Cerrar</button>
            </div>
        </div>
    </div>

    <div id="fondo__editarHistorial" class="fondo__modal">
        <form id="modal__editarHistorial" class="modal">
            <h1 class="modal__titulo">
                <i class="fa-solid fa-file-medical"></i> Historial Médico
            </h1>
            <div class="modal__contenido modal__contenido--historial">
                <h2>Personales Patológicos</h2>
                <div class="contenido__historial contenido__personalesPatologicos">
                    <span>Alergias:</span>
                    <input name="alergias" type="text" class="input" value="<%= historial && historial.pp ? historial.pp.alergias : '' %>">
                    <span>Tabaco:</span>
                    <input name="tabaco" type="text" class="input" value="<%= historial && historial.pp ? historial.pp.tabaco : '' %>">
                    <span>Alcohol:</span>
                    <input name="alcohol" type="text" class="input" value="<%= historial && historial.pp ? historial.pp.alcohol : '' %>">
                    <span>Drogas:</span>
                    <input name="drogas" type="text" class="input" value="<%= historial && historial.pp ? historial.pp.drogas : '' %>">
                    <span>Padecimientos:</span>
                    <input name="padecimientos" type="text" class="input" value="<%= historial && historial.pp ? historial.pp.padecimientos : '' %>">
                    <span>Medicamentos:</span>
                    <input name="medicamentos" type="text" class="input" value="<%= historial && historial.pp ? historial.pp.medicamentos : '' %>">
                    <span>Quirúrgicos:</span>
                    <input name="quirurgicos" type="text" class="input" value="<%= historial && historial.pp ? historial.pp.quirurgicos : '' %>">
                    <span>Traumatológicos:</span>
                    <input name="traumatologicos" type="text" class="input" value="<%= historial && historial.pp ? historial.pp.traumatologicos : '' %>">
                    <span>Transfusionales:</span>
                    <input name="transfusionales" type="text" class="input" value="<%= historial && historial.pp ? historial.pp.transfusionales : '' %>">
                    <span>Intolerancia a Medicamentos:</span>
                    <input name="intoleranciaMedicamentos" type="text" class="input" value="<%= historial && historial.pp ? historial.pp.intoleranciaMedicamentos : '' %>">
                    <span>Otros:</span>
                    <input name="perPatOtros" type="text" class="input" value="<%= historial && historial.pp ? historial.pp.otros : '' %>">
                </div>
                
                <h2>Personales No Patológicos</h2>
                <div class="contenido__historial contenido__personalesNoPatologicos">
                    <span>Ejercicio:</span>
                    <input name="ejercicio" type="text" class="input" value="<%= historial && historial.pnp ? historial.pnp.ejercicio : '' %>">
                    <span>Suplementos:</span>
                    <input name="suplementos" type="text" class="input" value="<%= historial && historial.pnp ? historial.pnp.suplementos : '' %>">
                    <span>Viajes Recientes:</span>
                    <input name="viajesRecientes" type="text" class="input" value="<%= historial && historial.pnp ? historial.pnp.viajesRecientes : '' %>">
                    <span>Tatuajes:</span>
                    <input name="tatuajes" type="text" class="input" value="<%= historial && historial.pnp ? historial.pnp.tatuajes : '' %>">
                    <span>Perforaciones:</span>
                    <input name="perforaciones" type="text" class="input" value="<%= historial && historial.pnp ? historial.pnp.perforaciones : '' %>">
                    <span>Otros:</span>
                    <input name="perNoPatOtros" type="text" class="input" value="<%= historial && historial.pnp ? historial.pnp.otros : '' %>">
                </div>

                <h2>Antecedentes Heredofamiliares</h2>
                <div class="contenedor__antecedentesHeredofamiliares">
                    <table class="tabla__antecedentesHeredofamiliares">
                        <thead>
                            <tr>
                                <th></th>
                                <th class="familiares familiar__abuelos">Abuelos</th>
                                <th class="familiares familiar__padre">Padre</th>
                                <th class="familiares familiar__madre">Madre</th>
                                <th class="familiares familiar__hermanos">Hermanos</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Diabetes</td>
                                <td><input name="diabetesAbuelos" type="text" class="input input__diabetes--abuelos" value="<%= historial && historial.ah ? historial.ah.diabetesAbuelos : '' %>" disabled></td>
                                <td><input name="diabetesPadre" type="text" class="input input__diabetes--padre" value="<%= historial && historial.ah ? historial.ah.diabetesPadre : '' %>" disabled></td>
                                <td><input name="diabetesMadre" type="text" class="input input__diabetes--madre" value="<%= historial && historial.ah ? historial.ah.diabetesMadre : '' %>" disabled></td>
                                <td><input name="diabetesHermanos" type="text" class="input input__diabetes--hermanos" value="<%= historial && historial.ah ? historial.ah.diabetesHermanos : '' %>" disabled></td>
                            </tr>
                            <tr>
                                <td>Nefropatías</td>
                                <td><input name="nefropatiasAbuelos" type="text" class="input" value="<%= historial && historial.ah ? historial.ah.nefropatiasAbuelos : '' %>" disabled></td>
                                <td><input name="nefropatiasPadre" type="text" class="input" value="<%= historial && historial.ah ? historial.ah.nefropatiasPadre : '' %>" disabled></td>
                                <td><input name="nefropatiasMadre" type="text" class="input" value="<%= historial && historial.ah ? historial.ah.nefropatiasMadre : '' %>" disabled></td>
                                <td><input name="nefropatiasHermanos" type="text" class="input" value="<%= historial && historial.ah ? historial.ah.nefropatiasHermanos : '' %>" disabled></td>
                            </tr>
                            <tr>
                                <td>Enfermedades Mentales</td>
                                <td><input name="mentalesAbuelos" type="text" class="input" value="<%= historial && historial.ah ? historial.ah.mentalesAbuelos : '' %>" disabled></td>
                                <td><input name="mentalesPadre" type="text" class="input" value="<%= historial && historial.ah ? historial.ah.mentalesPadre : '' %>" disabled></td>
                                <td><input name="mentalesMadre" type="text" class="input" value="<%= historial && historial.ah ? historial.ah.mentalesMadre : '' %>" disabled></td>
                                <td><input name="mentalesHermanos" type="text" class="input" value="<%= historial && historial.ah ? historial.ah.mentalesHermanos : '' %>" disabled></td>
                            </tr>
                            <tr>
                                <td>Hipertensión Arterial</td>
                                <td><input name="hipertensionAbuelos" type="text" class="input" value="<%= historial && historial.ah ? historial.ah.hipertensionAbuelos : '' %>" disabled></td>
                                <td><input name="hipertensionPadre" type="text" class="input" value="<%= historial && historial.ah ? historial.ah.hipertensionPadre : '' %>" disabled></td>
                                <td><input name="hipertensionMadre" type="text" class="input" value="<%= historial && historial.ah ? historial.ah.hipertensionMadre : '' %>" disabled></td>
                                <td><input name="hipertensionHermanos" type="text" class="input" value="<%= historial && historial.ah ? historial.ah.hipertensionHermanos : '' %>" disabled></td>
                            </tr>
                            <tr>
                                <td>Oncológicos</td>
                                <td><input name="oncologicosAbuelos" type="text" class="input" value="<%= historial && historial.ah ? historial.ah.oncologicosAbuelos : '' %>" disabled></td>
                                <td><input name="oncologicosPadre" type="text" class="input" value="<%= historial && historial.ah ? historial.ah.oncologicosPadre : '' %>" disabled></td>
                                <td><input name="oncologicosMadre" type="text" class="input" value="<%= historial && historial.ah ? historial.ah.oncologicosMadre : '' %>" disabled></td>
                                <td><input name="oncologicosHermanos" type="text" class="input" value="<%= historial && historial.ah ? historial.ah.oncologicosHermanos : '' %>" disabled></td>
                            </tr>
                            <tr>
                                <td>Hepatopatías</td>
                                <td><input name="hepatopatiasAbuelos" type="text" class="input" value="<%= historial && historial.ah ? historial.ah.hepatopatiasAbuelos : '' %>" disabled></td>
                                <td><input name="hepatopatiasPadre" type="text" class="input" value="<%= historial && historial.ah ? historial.ah.hepatopatiasPadre : '' %>" disabled></td>
                                <td><input name="hepatopatiasMadre" type="text" class="input" value="<%= historial && historial.ah ? historial.ah.hepatopatiasMadre : '' %>" disabled></td>
                                <td><input name="hepatopatiasHermanos" type="text" class="input" value="<%= historial && historial.ah ? historial.ah.hepatopatiasHermanos : '' %>" disabled></td>
                            </tr>
                            <tr>
                                <td>Otros</td>
                                <td><input name="heredoOtrosAbuelos" type="text" class="input" value="<%= historial && historial.ah ? historial.ah.heredoOtrosAbuelos : '' %>" disabled></td>
                                <td><input name="heredoOtrosPadre" type="text" class="input" value="<%= historial && historial.ah ? historial.ah.heredoOtrosPadre : '' %>" disabled></td>
                                <td><input name="heredoOtrosMadre" type="text" class="input" value="<%= historial && historial.ah ? historial.ah.heredoOtrosMadre : '' %>" disabled></td>
                                <td><input name="heredoOtrosHermanos" type="text" class="input" value="<%= historial && historial.ah ? historial.ah.heredoOtrosHermanos : '' %>" disabled></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="modal__botones">
                <button type="submit" class="boton-datos" id="guardarHistorial">
                    <i class="fa-solid fa-floppy-disk"></i> Guardar
                </button>
                <button type="button" class="boton-datos boton-cancelar" id="cerrar__editarHistorial">
                    <i class="fa-solid fa-x"></i> Cancelar
                </button>
            </div>
        </form>        
    </div>

    <%- include('../includes/loader') %>
</body>

</html>